#!/usr/bin/env bash
set -euo pipefail

# Capture caller's directory before changing
export PROJECT_DIR="${PROJECT_DIR:-$(pwd)}"

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
ROOT_DIR="$(dirname "$SCRIPT_DIR")"

cd "$ROOT_DIR"

# Check if container is running
if ! docker compose ps --status running | grep -q sandbox; then
    echo "Container not running. Starting..."
    "$SCRIPT_DIR/up"
fi

exec docker compose exec --workdir "$PROJECT_DIR" sandbox bash
