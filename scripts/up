#!/usr/bin/env bash
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
ROOT_DIR="$(dirname "$SCRIPT_DIR")"

cd "$ROOT_DIR"

# Run pre-start hooks
for hook in "$SCRIPT_DIR"/hooks/pre-start*; do
    [[ -x "$hook" ]] && "$hook"
done

echo "Starting claude-sandbox..."
docker compose up -d "$@"

# Run post-start hooks
for hook in "$SCRIPT_DIR"/hooks/post-start*; do
    [[ -x "$hook" ]] && "$hook"
done

echo "Container started. Use './scripts/shell' to enter."
